<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prospectus - Loving Hearts Day Care</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Add these styles */
        .doc-badge {
            display: inline-block;
            background: #e91e63;
            color: white;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin: 5px 0;
            font-weight: 500;
        }
        
        .doc-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 10px;
        }
        
        .doc-date {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        .no-docs {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .no-docs i {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        /* Fix for document cards */
        .document-card {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
            padding: 25px;
        }
        
        .document-card i.fa-file-pdf {
            font-size: 2.5rem;
            color: #e91e63;
        }
        
        .document-card i.fa-file-word {
            font-size: 2.5rem;
            color: #2b579a;
        }
        
        .document-card i.fa-file-excel {
            font-size: 2.5rem;
            color: #217346;
        }
        
        .document-card i.fa-file {
            font-size: 2.5rem;
            color: #757575;
        }
        
        .doc-content {
            flex: 1;
        }
        
        .doc-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 180px;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #e91e63;
            color: #e91e63;
        }
        
        .btn-outline:hover {
            background: #e91e63;
            color: white;
        }
        
        .spinner {
            border: 3px solid #f3e5f5;
            border-top: 3px solid #e91e63;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .link-warning {
            background: #fff3e0;
            color: #ef6c00;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.85rem;
            margin-top: 10px;
            text-align: center;
        }
        
        .link-warning i {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <i class="fas fa-heart"></i>
                <span>Loving Hearts Day Care</span>
            </a>
            <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#fees">Fees</a></li>
                <li><a href="index.html#requirements">Requirements</a></li>
                <li><a href="index.html#contact">Contact</a></li>
                <li><a href="admin.html">Admin</a></li>
            </ul>
        </div>
    </nav>

    <div class="prospectus-container">
        <div class="container">
            <div class="prospectus-content">
                <h1 class="section-title">Prospectus & Documents</h1>
                <p>Download official documents and prospectuses for Loving Hearts Day Care</p>
                
                <div class="document-list" id="documentsList">
                    <!-- Documents will load here -->
                    <div class="spinner" id="loadingSpinner"></div>
                </div>
                
                <div style="margin-top: 40px; text-align: center;">
                    <p>Need printed copies? Contact the school administration.</p>
                    <a href="index.html#contact" class="btn btn-secondary">
                        <i class="fas fa-phone-alt"></i> Contact Us
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-heart"></i>
                    <h3>Loving Hearts Day Care</h3>
                    <p>Nurturing Tomorrow's Leaders Today</p>
                </div>
                <div class="footer-links">
                    <a href="index.html">Home</a>
                    <a href="index.html#fees">Fees</a>
                    <a href="index.html#requirements">Requirements</a>
                    <a href="index.html#contact">Contact</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Loving Hearts Day Care. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle for prospectus page
        document.querySelector('.menu-toggle').addEventListener('click', function() {
            document.querySelector('.nav-menu').classList.toggle('active');
        });
        
        // Function to extract file ID from Google Drive URL
        function extractFileId(url) {
            // Try multiple patterns to extract file ID
            const patterns = [
                /\/d\/([a-zA-Z0-9_-]+)/,                    // /d/FILE_ID/
                /id=([a-zA-Z0-9_-]+)/,                      // id=FILE_ID
                /\/file\/d\/([a-zA-Z0-9_-]+)/,              // /file/d/FILE_ID/
                /\/open\?id=([a-zA-Z0-9_-]+)/,              // /open?id=FILE_ID
                /\/uc\?id=([a-zA-Z0-9_-]+)/                 // /uc?id=FILE_ID
            ];
            
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match && match[1]) {
                    return match[1];
                }
            }
            return null;
        }
        
        // Function to get direct download link from Google Drive URL
        function getDirectDownloadLink(url) {
            const fileId = extractFileId(url);
            if (fileId) {
                return `https://drive.google.com/uc?export=download&id=${fileId}`;
            }
            return url; // Return original if can't extract
        }
        
        // Function to get file icon based on URL
        function getFileIcon(url) {
            if (url.includes('.pdf') || url.toLowerCase().endsWith('.pdf')) return 'fa-file-pdf';
            if (url.includes('.doc') || url.toLowerCase().endsWith('.doc') || url.toLowerCase().endsWith('.docx')) return 'fa-file-word';
            if (url.includes('.xls') || url.includes('.xlsx')) return 'fa-file-excel';
            if (url.includes('.jpg') || url.includes('.jpeg') || url.includes('.png')) return 'fa-file-image';
            return 'fa-file';
        }
        
        // Function to get file type name
        function getFileType(url) {
            if (url.includes('.pdf')) return 'PDF';
            if (url.includes('.doc')) return 'Word';
            if (url.includes('.xls')) return 'Excel';
            if (url.includes('.jpg') || url.includes('.jpeg')) return 'Image';
            if (url.includes('.png')) return 'Image';
            return 'Document';
        }
        
        // Load documents from localStorage
        function loadDocuments() {
            const container = document.getElementById('documentsList');
            const spinner = document.getElementById('loadingSpinner');
            
            // Default documents (always shown)
            const defaultDocs = [
                {
                    id: 'boarding',
                    title: "Boarding Prospectus",
                    description: "Complete boarding information including fees, requirements, and policies.",
                    link: "", // Empty for now - admin needs to add
                    type: "prospectus",
                    date: "2024",
                    note: "Contact admin to add download link"
                },
                {
                    id: 'daycare',
                    title: "Day Care Prospectus",
                    description: "Information for day students including fee structure and requirements.",
                    link: "", // Empty for now - admin needs to add
                    type: "prospectus",
                    date: "2024",
                    note: "Contact admin to add download link"
                }
            ];
            
            // Get documents from localStorage (added by admin)
            const storedDocs = JSON.parse(localStorage.getItem('lovingHeartsDocuments') || '[]');
            
            // Combine all documents (admin docs first, then defaults)
            const allDocs = [...storedDocs, ...defaultDocs];
            
            // Clear loading spinner
            setTimeout(() => {
                if (spinner) spinner.style.display = 'none';
                
                if (allDocs.length === 0) {
                    container.innerHTML = `
                        <div class="no-docs">
                            <i class="fas fa-folder-open"></i>
                            <h3>No documents available yet</h3>
                            <p>Documents will appear here once added by admin</p>
                        </div>
                    `;
                    return;
                }
                
                // Clear and rebuild document list
                container.innerHTML = '';
                
                allDocs.forEach(doc => {
                    const hasValidLink = doc.link && doc.link.trim() !== '';
                    const icon = getFileIcon(doc.link);
                    const fileType = getFileType(doc.link);
                    const directLink = hasValidLink ? getDirectDownloadLink(doc.link) : '#';
                    
                    const card = document.createElement('div');
                    card.className = 'document-card';
                    
                    card.innerHTML = `
                        <div class="doc-content">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                                <i class="fas ${icon}"></i>
                                <div>
                                    <h3 style="margin: 0 0 5px 0;">${doc.title}</h3>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        ${doc.type ? `<span class="doc-badge">${doc.type}</span>` : ''}
                                        ${fileType ? `<span style="font-size: 0.85rem; color: #666;">${fileType}</span>` : ''}
                                        ${doc.date ? `<span style="font-size: 0.85rem; color: #999;">${doc.date}</span>` : ''}
                                    </div>
                                </div>
                            </div>
                            <p style="margin: 10px 0 15px 0; color: #555;">${doc.description}</p>
                            ${doc.note ? `<div class="link-warning"><i class="fas fa-info-circle"></i> ${doc.note}</div>` : ''}
                        </div>
                        <div class="doc-buttons">
                            ${hasValidLink ? `
                                <a href="${directLink}" class="download-btn" target="_blank">
                                    <i class="fas fa-download"></i> Download
                                </a>
                                <a href="${doc.link}" class="btn btn-outline" target="_blank">
                                    <i class="fas fa-eye"></i> Preview Online
                                </a>
                                <small style="color: #666; font-size: 0.8rem; text-align: center; margin-top: 5px;">
                                    Click "Download" to save file
                                </small>
                            ` : `
                                <button class="download-btn disabled" disabled style="opacity: 0.6;">
                                    <i class="fas fa-download"></i> Download Not Available
                                </button>
                                <div class="link-warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Download link will be added soon
                                </div>
                            `}
                        </div>
                    `;
                    
                    container.appendChild(card);
                });
            }, 500);
        }
        
        // Also add smooth scrolling for anchor links
        function initSmoothScroll() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        }
        
        // Load documents when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadDocuments();
            initSmoothScroll();
            
            // Also reload documents when coming back to page
            window.addEventListener('focus', function() {
                // Check if localStorage was updated
                loadDocuments();
            });
        });
        
        // For debugging: log what's in localStorage
        console.log('Current documents in localStorage:', JSON.parse(localStorage.getItem('lovingHeartsDocuments') || '[]'));
    </script>
</body>
</html>
